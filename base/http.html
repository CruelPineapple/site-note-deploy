<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP | 一个云鬼</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="我悲痛欲绝，跳进了家门口的井里">
    
    <link rel="preload" href="/note/assets/css/0.styles.3ff7832e.css" as="style"><link rel="preload" href="/note/assets/js/app.9cd70e36.js" as="script"><link rel="preload" href="/note/assets/js/2.928e56f7.js" as="script"><link rel="preload" href="/note/assets/js/63.e9f7d300.js" as="script"><link rel="prefetch" href="/note/assets/js/10.0ed9cdaf.js"><link rel="prefetch" href="/note/assets/js/11.5c00f895.js"><link rel="prefetch" href="/note/assets/js/12.3c7c0ea9.js"><link rel="prefetch" href="/note/assets/js/13.473c3247.js"><link rel="prefetch" href="/note/assets/js/14.90435a06.js"><link rel="prefetch" href="/note/assets/js/15.8d079d92.js"><link rel="prefetch" href="/note/assets/js/16.ca3dc554.js"><link rel="prefetch" href="/note/assets/js/17.cfd6514c.js"><link rel="prefetch" href="/note/assets/js/18.bf62b38b.js"><link rel="prefetch" href="/note/assets/js/19.712abb6e.js"><link rel="prefetch" href="/note/assets/js/20.4fec9fe2.js"><link rel="prefetch" href="/note/assets/js/21.506bbe3b.js"><link rel="prefetch" href="/note/assets/js/22.6ef3079f.js"><link rel="prefetch" href="/note/assets/js/23.ec6501c5.js"><link rel="prefetch" href="/note/assets/js/24.2ed68640.js"><link rel="prefetch" href="/note/assets/js/25.04480536.js"><link rel="prefetch" href="/note/assets/js/26.1270c43d.js"><link rel="prefetch" href="/note/assets/js/27.98c7a3d9.js"><link rel="prefetch" href="/note/assets/js/28.384c3d10.js"><link rel="prefetch" href="/note/assets/js/29.af1e1b65.js"><link rel="prefetch" href="/note/assets/js/3.0cc47948.js"><link rel="prefetch" href="/note/assets/js/30.bb9a637f.js"><link rel="prefetch" href="/note/assets/js/31.c82104e3.js"><link rel="prefetch" href="/note/assets/js/32.05b8c8a8.js"><link rel="prefetch" href="/note/assets/js/33.32938820.js"><link rel="prefetch" href="/note/assets/js/34.db5e5867.js"><link rel="prefetch" href="/note/assets/js/35.bcd1c697.js"><link rel="prefetch" href="/note/assets/js/36.1a4c693d.js"><link rel="prefetch" href="/note/assets/js/37.0509106a.js"><link rel="prefetch" href="/note/assets/js/38.7899b4f6.js"><link rel="prefetch" href="/note/assets/js/39.0153ca50.js"><link rel="prefetch" href="/note/assets/js/4.09ee8a39.js"><link rel="prefetch" href="/note/assets/js/40.be8f6ade.js"><link rel="prefetch" href="/note/assets/js/41.0f368145.js"><link rel="prefetch" href="/note/assets/js/42.21c8ce07.js"><link rel="prefetch" href="/note/assets/js/43.598d73f3.js"><link rel="prefetch" href="/note/assets/js/44.c76fa2e0.js"><link rel="prefetch" href="/note/assets/js/45.39ff6a06.js"><link rel="prefetch" href="/note/assets/js/46.ad9ea498.js"><link rel="prefetch" href="/note/assets/js/47.f4617b38.js"><link rel="prefetch" href="/note/assets/js/48.467e8326.js"><link rel="prefetch" href="/note/assets/js/49.d70f36e3.js"><link rel="prefetch" href="/note/assets/js/5.18616f39.js"><link rel="prefetch" href="/note/assets/js/50.419a4d37.js"><link rel="prefetch" href="/note/assets/js/51.872c696b.js"><link rel="prefetch" href="/note/assets/js/52.74a436ad.js"><link rel="prefetch" href="/note/assets/js/53.3e0196e0.js"><link rel="prefetch" href="/note/assets/js/54.93c24b1f.js"><link rel="prefetch" href="/note/assets/js/55.7e806811.js"><link rel="prefetch" href="/note/assets/js/56.d17194ce.js"><link rel="prefetch" href="/note/assets/js/57.a4349f14.js"><link rel="prefetch" href="/note/assets/js/58.ddf67ca3.js"><link rel="prefetch" href="/note/assets/js/59.1f86315e.js"><link rel="prefetch" href="/note/assets/js/6.498ab014.js"><link rel="prefetch" href="/note/assets/js/60.1cd84aba.js"><link rel="prefetch" href="/note/assets/js/61.2d5f1392.js"><link rel="prefetch" href="/note/assets/js/62.d0fa7085.js"><link rel="prefetch" href="/note/assets/js/64.d1020319.js"><link rel="prefetch" href="/note/assets/js/65.0c80c667.js"><link rel="prefetch" href="/note/assets/js/66.ccdc1732.js"><link rel="prefetch" href="/note/assets/js/67.457494cf.js"><link rel="prefetch" href="/note/assets/js/68.e027a88b.js"><link rel="prefetch" href="/note/assets/js/69.0877d57d.js"><link rel="prefetch" href="/note/assets/js/7.f2df6e20.js"><link rel="prefetch" href="/note/assets/js/70.106881e5.js"><link rel="prefetch" href="/note/assets/js/71.1ec95702.js"><link rel="prefetch" href="/note/assets/js/72.5d137f27.js"><link rel="prefetch" href="/note/assets/js/73.64753bb4.js"><link rel="prefetch" href="/note/assets/js/74.e19ff2b3.js"><link rel="prefetch" href="/note/assets/js/75.60de1874.js"><link rel="prefetch" href="/note/assets/js/76.d5d684df.js"><link rel="prefetch" href="/note/assets/js/77.16a6a975.js"><link rel="prefetch" href="/note/assets/js/78.89e47680.js"><link rel="prefetch" href="/note/assets/js/79.f1004814.js"><link rel="prefetch" href="/note/assets/js/8.4c6d003f.js"><link rel="prefetch" href="/note/assets/js/80.0d1a1edb.js"><link rel="prefetch" href="/note/assets/js/9.a01747ac.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.3ff7832e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">一个云鬼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/Fe/" class="nav-link">
  Note
</a></div><div class="nav-item"><a href="/note/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/CruelPineapple" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/Fe/" class="nav-link">
  Note
</a></div><div class="nav-item"><a href="/note/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/CruelPineapple" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>红宝书笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/base/tcp拥塞.html" class="sidebar-link">TCP拥塞控制</a></li><li><a href="/note/base/34.html" class="sidebar-link">三次握手四次挥手</a></li><li><a href="/note/base/http.html" aria-current="page" class="active sidebar-link">HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/base/http.html#http1-1" class="sidebar-link">HTTP1.1</a></li><li class="sidebar-sub-header"><a href="/note/base/http.html#spdy" class="sidebar-link">SPDY</a></li><li class="sidebar-sub-header"><a href="/note/base/http.html#http2" class="sidebar-link">HTTP2</a></li><li class="sidebar-sub-header"><a href="/note/base/http.html#https" class="sidebar-link">HTTPS</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>我不知道的JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="http"><a href="#http" class="header-anchor">#</a> HTTP</h1> <p>基于TCP的协议，无状态的（请求之间没有关系）1.1及以前的HTTP报文都是可读的，HTTP2将报文内容嵌入二进制分帧，帮助头部压缩和复用等，不过客户端会重组二进制帧，因此看起来是一样的。</p> <p>HTTP请求报文像这样</p> <div class="language- extra-class"><pre class="language-text"><code>GET /asd/?vmid=672342685 HTTP/1.1
Host: sakurajimama1.ltd
Proxy-Connection: keep-alive
Accept: application/json, text/plain, */*
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36
Referer: http://sakurajimama1.ltd/asouldigits/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
If-None-Match: W/&quot;14-h5JqNPPusBBiwamERpUFheOmByM&quot;
</code></pre></div><p>第一行是方法，路径和协议版本，下面就是头部，GET是没有请求体的</p> <p>响应报文像这样</p> <div class="language- extra-class"><pre class="language-text"><code>HTTP/1.1 200 OK
Content-Length: 20
Connection: keep-alive
Content-Type: application/json; charset=utf-8
Date: Wed, 13 Oct 2021 12:09:41 GMT
Etag: W/&quot;14-aKoSYNdjPgyO65RMB9etOxIY/5M&quot;
Keep-Alive: timeout=4
Proxy-Connection: keep-alive
Server: nginx/1.18.0
X-Powered-By: Express
</code></pre></div><p>第一行是协议，状态码和状态信息，下面是头部</p> <h2 id="http1-1"><a href="#http1-1" class="header-anchor">#</a> HTTP1.1</h2> <p>引入更多缓存控制策略，例如上面的If-None-Match就是HTTP1.1引入的。</p> <p>优化了带宽使用，在1.0中，可能值请求了一个对象的某个部分，但是服务器把整个对象送过来了（不懂为什么会发生这种情况）。1.1引入range头部，允许只请求资源的某个部分，返回码是206</p> <p>增加了24个错误响应状态码</p> <p>能够处理Host头部，1.0认为每台服务器都有一个唯一的IP地址，因此没有传递主机名，但是随着虚拟主机的发展，一台物理服务器上可能存在多个虚拟主机，因此需要Host头部用于识别</p> <p>支持长连接和流水线，一个HTTP连接不会立刻关闭，能够进行多次请求和相应，多个请求可以连续发送（流水线发送）</p> <h2 id="spdy"><a href="#spdy" class="header-anchor">#</a> SPDY</h2> <p>谷歌提出的基于TCP的应用层协议，旨在通过压缩，多路复用和优先级来缩短网页的家在时间。SPDY意思是speedy，快！</p> <p>SPDY在HTTP之下，TCP和SSL之上。</p> <p>HTTP的不足有：单路连接，请求低效，只允许客户端主动发起请求，头部冗余（会反复发送）</p> <h3 id="spdy优点"><a href="#spdy优点" class="header-anchor">#</a> SPDY优点</h3> <p>多路复用，请求优化：一个SPDY连接内可以有无限个并行的请求，即允许多个并发HTTP请求共用一个TCP会话。另外还可以设置多路复用的优先级，而不是传统HTTP那样按照先入先出一个一个处理请求，它会选择性地先传输CSS这样的重要资源，然后传送图标等不太重要的资源</p> <p>服务器推送：服务器可以主动向客户端推送数据，例如在客户端请求CSS文件的时候就主动把该页面对应的js推送给客户端，就不需要客户端再请求了。</p> <p>压缩HTTP头部：舍弃不必要的头部信息</p> <p>强制使用SSL：更安全</p> <h2 id="http2"><a href="#http2" class="header-anchor">#</a> HTTP2</h2> <p>可以说是SPDY的升级版，区别在：</p> <p>HTTP2支持HTTP，而SPDY强制使用HTTPS</p> <p>HTTP2头部采用HPACK压缩，而SPDY采用的DEFLATE</p> <p>HPACK是一个表，为头部名设置索引，并使用索引值指代某些非常常见的头部值</p> <p>DEFLATE同时使用LZ77（一种字典编码）和哈夫曼编码，是一种无损压缩算法</p> <p>HTTP2使用了二进制格式（二进制分帧），相比HTTP1.x新增多路复用（每个请求可以随机混杂在一起，通过id分类到不同的请求），头部压缩，服务端推送（和SPDY一样的）</p> <h3 id="http2的多路复用和1-x的长连接复用区别"><a href="#http2的多路复用和1-x的长连接复用区别" class="header-anchor">#</a> HTTP2的多路复用和1.x的长连接复用区别</h3> <p>长连接是串行处理，某个任务耗时严重会影响后续任务。多路复用是并行，互不影响</p> <p>关于流水线（管道化），它要求按序发送和返回，因为HTTP报文没有序号。另外流水线可能导致队头阻塞，因此流水线一般是默认关闭的。</p> <p>HTTP2不使用流水线方式，而是使用帧，每个帧分配序号，可以乱序发送后组装。不过基于TCP的HTTP2仍然可能出现TCP的队头阻塞</p> <h3 id="tcp队头阻塞-新的性能瓶颈"><a href="#tcp队头阻塞-新的性能瓶颈" class="header-anchor">#</a> TCP队头阻塞（新的性能瓶颈）</h3> <p>因为一个分组丢失，后续分组无法按序到达接收端的时候，后续分组将被缓存直到丢失分组被重传并接收成功，这时候TCP才会将组装好的报文递交上层协议。这个问题是TCP自身机制决定的，HTTP2的多路复用无法解决，除非HTTP2使用其他底层协议。</p> <h2 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h2> <p>对称加密速度快，但是密钥容易泄露，非对称加密更安全，但是加解密速度较慢</p> <p>HTTPS混合使用对称加密和非对称加密，在明文传输的基础上加密信息，同时保证了性能</p> <p>HTTPS协议需要CA证书，证书是非对称加密的一部分，包含公钥和私钥。私钥保存在服务器，公钥包含在证书里，在响应HTTPS请求的时候发送给客户端，证书还包含电子签名（防止篡改证书）以及有效时间等信息。</p> <p>客户端会验证证书的颁布机构等信息，如果证书有问题会对用户发出警告。</p> <p>如果没有问题，客户端就会使用证书内的公钥加密一个随机码，将其发送给服务端，服务端使用私钥解密这个随机码。</p> <p>此后的数据传输，双方都使用上述随机码作为对称加密的密钥进行加解密。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/base/34.html" class="prev">
        三次握手四次挥手
      </a></span> <span class="next"><a href="/note/Fe/vue/使用Array.unshift.html">
        Array.unshift()实现可选picker
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.9cd70e36.js" defer></script><script src="/note/assets/js/2.928e56f7.js" defer></script><script src="/note/assets/js/63.e9f7d300.js" defer></script>
  </body>
</html>
