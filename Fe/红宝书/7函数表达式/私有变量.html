<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>私有变量 | Rice Shower</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="一马当先，万马无光">
    
    <link rel="preload" href="/note/assets/css/0.styles.ba1ec7e7.css" as="style"><link rel="preload" href="/note/assets/js/app.34f6b735.js" as="script"><link rel="preload" href="/note/assets/js/2.928e56f7.js" as="script"><link rel="preload" href="/note/assets/js/23.f2081249.js" as="script"><link rel="prefetch" href="/note/assets/js/10.15e7bec5.js"><link rel="prefetch" href="/note/assets/js/11.aff926c5.js"><link rel="prefetch" href="/note/assets/js/12.528bee85.js"><link rel="prefetch" href="/note/assets/js/13.b9109ef7.js"><link rel="prefetch" href="/note/assets/js/14.055a848f.js"><link rel="prefetch" href="/note/assets/js/15.602d2f08.js"><link rel="prefetch" href="/note/assets/js/16.f4178997.js"><link rel="prefetch" href="/note/assets/js/17.09670d94.js"><link rel="prefetch" href="/note/assets/js/18.02c9dbf3.js"><link rel="prefetch" href="/note/assets/js/19.dbb7b151.js"><link rel="prefetch" href="/note/assets/js/20.a362c339.js"><link rel="prefetch" href="/note/assets/js/21.2163132f.js"><link rel="prefetch" href="/note/assets/js/22.f18b6819.js"><link rel="prefetch" href="/note/assets/js/24.10d3eaa8.js"><link rel="prefetch" href="/note/assets/js/25.b647fd59.js"><link rel="prefetch" href="/note/assets/js/26.75a1a447.js"><link rel="prefetch" href="/note/assets/js/27.f1a87145.js"><link rel="prefetch" href="/note/assets/js/28.8e20940d.js"><link rel="prefetch" href="/note/assets/js/29.0c3b5d9c.js"><link rel="prefetch" href="/note/assets/js/3.e3eefc96.js"><link rel="prefetch" href="/note/assets/js/30.5aded710.js"><link rel="prefetch" href="/note/assets/js/31.917d0d97.js"><link rel="prefetch" href="/note/assets/js/32.4fa2341f.js"><link rel="prefetch" href="/note/assets/js/33.28e143bd.js"><link rel="prefetch" href="/note/assets/js/34.b9aac71e.js"><link rel="prefetch" href="/note/assets/js/35.3c105dbc.js"><link rel="prefetch" href="/note/assets/js/36.e469ce98.js"><link rel="prefetch" href="/note/assets/js/37.76c9f6dd.js"><link rel="prefetch" href="/note/assets/js/38.97304ebe.js"><link rel="prefetch" href="/note/assets/js/39.80729f85.js"><link rel="prefetch" href="/note/assets/js/4.e05c873c.js"><link rel="prefetch" href="/note/assets/js/40.fa7a2eac.js"><link rel="prefetch" href="/note/assets/js/41.e2996b1e.js"><link rel="prefetch" href="/note/assets/js/42.5cfdb5b1.js"><link rel="prefetch" href="/note/assets/js/43.bfef9456.js"><link rel="prefetch" href="/note/assets/js/44.806eea7d.js"><link rel="prefetch" href="/note/assets/js/45.28990f13.js"><link rel="prefetch" href="/note/assets/js/5.76fc70b2.js"><link rel="prefetch" href="/note/assets/js/6.498ab014.js"><link rel="prefetch" href="/note/assets/js/7.6898f26e.js"><link rel="prefetch" href="/note/assets/js/8.8e1f5cda.js"><link rel="prefetch" href="/note/assets/js/9.f69b8b25.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.ba1ec7e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">Rice Shower</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/Fe/" class="nav-link router-link-active">
  Note
</a></div><div class="nav-item"><a href="/note/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/CruelPineapple" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/Fe/" class="nav-link router-link-active">
  Note
</a></div><div class="nav-item"><a href="/note/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/CruelPineapple" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>红宝书笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/Fe/红宝书/Number.html" class="sidebar-link">Number类型</a></li><li><a href="/note/Fe/红宝书/parseInt.html" class="sidebar-link">数值转换</a></li><li><a href="/note/Fe/红宝书/String.html" class="sidebar-link">String类型</a></li><li><a href="/note/Fe/红宝书/apply和参数.html" class="sidebar-link">apply和函数参数</a></li><li><a href="/note/Fe/红宝书/Array.html" class="sidebar-link">Array类型</a></li><li><a href="/note/Fe/红宝书/RegExp.html" class="sidebar-link">RegExp类型</a></li><li><a href="/note/Fe/红宝书/Function.html" class="sidebar-link">Function类型</a></li><li><a href="/note/Fe/红宝书/基本包装类型.html" class="sidebar-link">基本包装类型</a></li><li><a href="/note/Fe/红宝书/单体内置对象.html" class="sidebar-link">单体内置对象</a></li><li><a href="/note/Fe/红宝书/对象基础.html" class="sidebar-link">对象基础</a></li><li><a href="/note/Fe/红宝书/创建对象.html" class="sidebar-link">创建对象</a></li><li><a href="/note/Fe/红宝书/原型.html" class="sidebar-link">原型</a></li><li><a href="/note/Fe/红宝书/继承和原型链.html" class="sidebar-link">继承</a></li><li><a href="/note/Fe/红宝书/其他继承.html" class="sidebar-link">其他继承方式</a></li><li><a href="/note/Fe/红宝书/7函数表达式/闭包.html" class="sidebar-link">闭包</a></li><li><a href="/note/Fe/红宝书/7函数表达式/this.html" class="sidebar-link">this</a></li><li><a href="/note/Fe/红宝书/7函数表达式/模仿块级作用域.html" class="sidebar-link">模仿块级作用域</a></li><li><a href="/note/Fe/红宝书/7函数表达式/私有变量.html" class="active sidebar-link">私有变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/Fe/红宝书/7函数表达式/私有变量.html#静态私有变量" class="sidebar-link">静态私有变量</a></li><li class="sidebar-sub-header"><a href="/note/Fe/红宝书/7函数表达式/私有变量.html#模块模式" class="sidebar-link">模块模式</a></li><li class="sidebar-sub-header"><a href="/note/Fe/红宝书/7函数表达式/私有变量.html#增强模块模式" class="sidebar-link">增强模块模式</a></li></ul></li><li><a href="/note/Fe/红宝书/8BOM.html" class="sidebar-link">BOM</a></li><li><a href="/note/Fe/红宝书/9客户端检测.html" class="sidebar-link">客户端检测</a></li><li><a href="/note/Fe/红宝书/10DOM.html" class="sidebar-link">DOM</a></li><li><a href="/note/Fe/红宝书/11DOM2和DOM3.html" class="sidebar-link">DOM2/3</a></li><li><a href="/note/Fe/红宝书/13事件.html" class="sidebar-link">事件</a></li><li><a href="/note/Fe/红宝书/14表单脚本.html" class="sidebar-link">表单脚本</a></li><li><a href="/note/Fe/红宝书/17错误处理.html" class="sidebar-link">错误处理</a></li><li><a href="/note/Fe/红宝书/20JSON.html" class="sidebar-link">JSON</a></li><li><a href="/note/Fe/红宝书/21AJAX.html" class="sidebar-link">AJAX</a></li><li><a href="/note/Fe/红宝书/22高级技巧.html" class="sidebar-link">高级技巧</a></li><li><a href="/note/Fe/红宝书/22高级技巧2.html" class="sidebar-link">高级技巧2</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>力扣笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="私有变量"><a href="#私有变量" class="header-anchor">#</a> 私有变量</h1> <p>严格来说，js没有私有成员概念，但是任何在函数中定义的变量都可以认为是私有变量，因为它们不能在函数外面访问。如果在函数内部创建一个闭包，那么闭包通过自己的作用域连也可以访问这些变量，利用这一点，就可以创建用于访问私有变量的公有方法。有权访问私有变量和私有函数的公有方法被称为特权方法，创建特权方法有两种方式，第一种是在构造函数中定义特权方法：</p> <div class="language- extra-class"><pre class="language-text"><code>function MyObject(){
    //私有变量和私有函数
    var privateVariable = 10;

    function privateFunction(){
        return false;
    }

    this.publicMethod = function(){
        privateVariable++;
        return privateFunction();
    };
}
</code></pre></div><p>这个模式在构造函数内部定义了所有私有变量和函数，然后继续创建了能够访问这些私有成员的特权方法。特权方法作为闭包，有权访问在构造函数中定义的所有变量和函数。利用私有和特权成员，可以隐藏那些不应该被直接修改的数据：</p> <div class="language- extra-class"><pre class="language-text"><code>function Person(name){
    this.getName = function(){
        return name;
    };

    this.setName = function(value){
        name = value;
    };
}
</code></pre></div><p>这里Person中不需要显示指定一个变量来保存name值，因为getName方法作为闭包，始终能够拿到参数中的name值。
在构造函数只能够定义特权方法也有一个缺点，就是必须使用构造函数模式来达到这个目的，之前有提到过，构造函数模式的缺点就是会为每个实例重复创建同样一组新方法。静态私有变量实现的特权方法就可以避免这个问题。</p> <h2 id="静态私有变量"><a href="#静态私有变量" class="header-anchor">#</a> 静态私有变量</h2> <p>通过在私有作用域中定义私有变量或函数，同样可以创建特权方法：</p> <div class="language- extra-class"><pre class="language-text"><code>(function(){
    //私有变量和私有函数
    var privateVariable = 10;

    function privateFunction(){
        return false;
    }

    //构造函数
    MyObject = function(){};

    //特权方法
    MyObject.prototype.publicMethos = function(){
        privateVariable++;
        return privateFunction();
    }
})();
</code></pre></div><p>这个模式创建了一个私有作用域，并在其中封装了一个构造函数及相应的方法。在私有作用域中，首先定义了私有变量和私有函数，然后定义了构造函数及公有方法。公有方法定义在原型上，体现了典型的原型模式。需要注意，此模式使用了函数表达式而不是函数声明，因为函数声明只能创建局部函数，同时MyObject也没有使用var，为了把它搞成全局变量。这个模式的特权方法定义在原型上，因此所有实例使用同一个函数，而通过闭包，这个特权方法总是保存着对作用域的引用。</p> <div class="language- extra-class"><pre class="language-text"><code>(function(){

    var name = &quot;&quot;;

    Person = function(value){
        name = value;
    };

    Person.prototype.getName = function(){
        return name;
    };

    Person.protorype.setName = function(){
        name = value;
    };
})();

var person1 = new Person(&quot;Nicholas&quot;);
alert(person1.getName());  //Nicholas
person1.setName(&quot;Gerg&quot;);
alert(person1.getName());  //Gerg

var person2 = new Person(&quot;Michael&quot;);
alert(person2.getName());  //Michael
alert(person1.getName());  //Michael
</code></pre></div><p>这种模式下，name成为了一个静态的，由所有实例共享的属性。到底是使用实例变量还是静态私有变量，需要视情况决定。
我来对此模式进行总结：首先创建一个匿名函数表达式形成一个局部作用域，在这里创建静态私有变量。然后生成一个构造函数，在其原型上定义公有方法，这里的构造函数通过闭包连接至局部作用域。此时，通过构造函数创建的实例均连接至局部作用域中的变量。</p> <h2 id="模块模式"><a href="#模块模式" class="header-anchor">#</a> 模块模式</h2> <p>上面的模式用于为自定义类型创建私有变量和特权方法。而模块模式则是为单例创建私有变量和特权方法：</p> <div class="language- extra-class"><pre class="language-text"><code>var singleton = function(){
    //私有变量和私有函数
    var privateVariable = 10;

    function privateFunction(){
        return false;
    }

    //公有方法和属性
    return {
        publicProperty: true,
        publicMethod: function(){
            privateVariable++;
            return privateFunction();
        }
    };
}();
</code></pre></div><p>这个模式使用了一个返回对象的匿名函数，先在其中定义私有变量和函数，然后将一个对象字面量返回，这个对象只包含公共部分。这个模式在需要对单例进行初始化同时又需要维护其私有变量对时候会很有用。例如：</p> <div class="language- extra-class"><pre class="language-text"><code>var application = function(){
    //私有
    var components = new Array();

    //初始化
    components.push(new BaseComponent());

    //公共
    return {
        getComponentCount: function(){
            return components.length;
        },
        registerComponent: function(component){
            if(typeof component == &quot;object&quot;){
                components.push(component);
            }
        }
    };
}();
</code></pre></div><p>红宝书总结道：如果必须创建一个对象并以某些数据对其进行初始化，同时还要公开一些能够访问这些私有数据的方法，那么就可以使用这种模式。</p> <h2 id="增强模块模式"><a href="#增强模块模式" class="header-anchor">#</a> 增强模块模式</h2> <p>如果这个单例必须是某种类型的实例，就是增强模块模式</p> <div class="language- extra-class"><pre class="language-text"><code>var application = function(){
    var components = new Array();
    components.push(new BaseComponent());

    var app = new BaseComponent();
    app.getComponent = function(){
        return components.length;
    };
    app.rigisterComponent = function(component){
        if(typeof component == &quot;object&quot;){
            components.push(component);
        }
    };
    return app;
}
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/Fe/红宝书/7函数表达式/模仿块级作用域.html" class="prev">
        模仿块级作用域
      </a></span> <span class="next"><a href="/note/Fe/红宝书/8BOM.html">
        BOM
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.34f6b735.js" defer></script><script src="/note/assets/js/2.928e56f7.js" defer></script><script src="/note/assets/js/23.f2081249.js" defer></script>
  </body>
</html>
